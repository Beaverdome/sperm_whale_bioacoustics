---

title: Clan and coda type detection with RNN

keywords: fastai
sidebar: home_sidebar

summary: "results with and without pretraining, evaluating a simpler architecture"
description: "results with and without pretraining, evaluating a simpler architecture"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05_Clan_and_coda_type_detection_with_RNN.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Clan-detection">Clan detection<a class="anchor-link" href="#Clan-detection"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sperm_whale_bioacoustics.data</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sperm_whale_bioacoustics</span> <span class="kn">import</span> <span class="n">model_pretrain</span>

<span class="kn">from</span> <span class="nn">fastai2.basics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2.learner</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2.callback.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's load the pretrained model</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">datasets_clan</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span> <span class="o">=</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model_pretrain</span><span class="o">.</span><span class="n">Model</span><span class="p">())</span>
<span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;models/pretrained.pth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;pretrained&#39;</span><span class="p">);</span> <span class="c1"># to accomodate the CI pipeline on github</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's freeze the first layer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lstm1</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LSTM(1, 256, batch_first=True)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can manipulate the model in place.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lstm2</span><span class="o">.</span><span class="n">reset_parameters</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lin</span><span class="o">.</span><span class="n">reset_parameters</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">loss_func</span> <span class="o">=</span> <span class="n">BCEWithLogitsLossFlat</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Model(
  (lstm1): LSTM(1, 256, batch_first=True)
  (lstm2): LSTM(256, 256, batch_first=True)
  (lin): Linear(in_features=256, out_features=1, bias=True)
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we should be all set to train!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Model (Input shape: [&#39;128 x 9&#39;])
================================================================
Layer (type)         Output Shape         Param #    Trainable 
================================================================
LSTM                 [&#39;128 x 9 x 256&#39;, &#34;  265,216    False     
________________________________________________________________
LSTM                 [&#39;128 x 9 x 256&#39;, &#34;  526,336    True      
________________________________________________________________
Linear               128 x 1              257        True      
________________________________________________________________

Total params: 791,809
Total trainable params: 526,593
Total non-trainable params: 265,216

Optimizer used: &lt;function Adam at 0x7f07cc43fb90&gt;
Loss function: FlattenedLoss of BCEWithLogitsLoss()

Model unfrozen

Callbacks:
  - TrainEvalCallback
  - Recorder
  - ProgressCallback</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.33113112449646, 0.2089296132326126)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">accuracy_multi</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy_multi</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.693101</td>
      <td>0.691377</td>
      <td>0.500000</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.689917</td>
      <td>0.676007</td>
      <td>0.773684</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.674227</td>
      <td>0.588739</td>
      <td>0.752632</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.633185</td>
      <td>0.479968</td>
      <td>0.889474</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.551117</td>
      <td>0.279344</td>
      <td>0.921053</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.463237</td>
      <td>0.256698</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.391922</td>
      <td>0.237998</td>
      <td>0.931579</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.335008</td>
      <td>0.223441</td>
      <td>0.905263</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.287834</td>
      <td>0.200860</td>
      <td>0.921053</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.254404</td>
      <td>0.202940</td>
      <td>0.921053</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.227410</td>
      <td>0.189960</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.205059</td>
      <td>0.191279</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.186766</td>
      <td>0.180308</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.172343</td>
      <td>0.179979</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.161419</td>
      <td>0.185683</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.151804</td>
      <td>0.176266</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.144722</td>
      <td>0.179198</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.139412</td>
      <td>0.178529</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.134561</td>
      <td>0.176548</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.130330</td>
      <td>0.176251</td>
      <td>0.936842</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The paper reports an accuracy of 95.3% on the clan classification task. Our 93.6% is probably an okay result. I don't believe there is much sense in tweaking the training params at this point.</p>
<p>One thing that should be mentioned here, is that I am reporting the results on the validation set. This makes the code slightly simpler and shorter. Also, for the purposes of my inquiry, I think this is okay (my main goal is to gain better understanding of the ICI and to demonstrate the application of modern ML techniques to this data). For a rigorous scientific study, one should probably consider isolating a test set and running the verification on it, only once.</p>
<p>Without a test set, we risk fitting hyperarameters to our validation set. For a practical discussion of the train - val - test split, I would recommend this <a href="https://www.fast.ai/2017/11/13/validation-sets/">very informative post</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Does-pretraining-help?">Does pretraining help?<a class="anchor-link" href="#Does-pretraining-help?"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pretraining is a very useful technique, in many cases transfer learning is the only path to good results. Here, I am genuinely curious if the pretraining help. If it should help, that would be a very interesting finding.</p>
<p>Let's put this hypothesis to a test.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span>
    <span class="n">dls</span><span class="p">,</span>
    <span class="n">model_pretrain</span><span class="o">.</span><span class="n">Model</span><span class="p">(),</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy_multi</span><span class="p">],</span>
    <span class="n">loss_func</span><span class="o">=</span><span class="n">BCEWithLogitsLossFlat</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We don't load the weights nor do we modify the architecture</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [0.6932151317596436,0.5]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's train with the same settings as before.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy_multi</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.693099</td>
      <td>0.692973</td>
      <td>0.500000</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.692972</td>
      <td>0.692260</td>
      <td>0.757895</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.692486</td>
      <td>0.687826</td>
      <td>0.736842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.687545</td>
      <td>0.652679</td>
      <td>0.652632</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.671638</td>
      <td>0.588509</td>
      <td>0.710526</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.635740</td>
      <td>0.441967</td>
      <td>0.868421</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.565996</td>
      <td>0.321611</td>
      <td>0.921053</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.484575</td>
      <td>0.292535</td>
      <td>0.878947</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.417169</td>
      <td>0.246713</td>
      <td>0.915789</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.356033</td>
      <td>0.215033</td>
      <td>0.926316</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.305421</td>
      <td>0.180225</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.264068</td>
      <td>0.179078</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.232114</td>
      <td>0.176096</td>
      <td>0.931579</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.207051</td>
      <td>0.168313</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.187118</td>
      <td>0.167388</td>
      <td>0.947368</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.172579</td>
      <td>0.164708</td>
      <td>0.942105</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.159790</td>
      <td>0.174520</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.149672</td>
      <td>0.168237</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.141820</td>
      <td>0.165275</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.135311</td>
      <td>0.165159</td>
      <td>0.936842</td>
      <td>00:01</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In our experiment, pretraining didn't prove helpful.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Would-a-simpler-architecture-work?">Would a simpler architecture work?<a class="anchor-link" href="#Would-a-simpler-architecture-work?"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A two layer RNN strikes me as a very complex model for this task. I am curious if a smaller model could do equally well. Verifying this can help us construct models in the future on similar data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lstm1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lstm1</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin</span><span class="p">(</span><span class="n">h</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span>
    <span class="n">dls</span><span class="p">,</span>
    <span class="n">Model</span><span class="p">(),</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy_multi</span><span class="p">],</span>
    <span class="n">loss_func</span><span class="o">=</span><span class="n">BCEWithLogitsLossFlat</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy_multi</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.692815</td>
      <td>0.692256</td>
      <td>0.500000</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.692079</td>
      <td>0.689771</td>
      <td>0.657895</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.690140</td>
      <td>0.679033</td>
      <td>0.626316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.687375</td>
      <td>0.669220</td>
      <td>0.736842</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.676686</td>
      <td>0.618742</td>
      <td>0.726316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.657620</td>
      <td>0.569491</td>
      <td>0.710526</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.627126</td>
      <td>0.533899</td>
      <td>0.705263</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.580894</td>
      <td>0.355915</td>
      <td>0.905263</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.523001</td>
      <td>0.314599</td>
      <td>0.926316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.457365</td>
      <td>0.248672</td>
      <td>0.926316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.403369</td>
      <td>0.285901</td>
      <td>0.926316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.363228</td>
      <td>0.227825</td>
      <td>0.936842</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.320559</td>
      <td>0.208255</td>
      <td>0.921053</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.281835</td>
      <td>0.208674</td>
      <td>0.931579</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.251861</td>
      <td>0.209114</td>
      <td>0.926316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.227318</td>
      <td>0.190513</td>
      <td>0.926316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.209392</td>
      <td>0.195393</td>
      <td>0.931579</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.194586</td>
      <td>0.192219</td>
      <td>0.931579</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.181710</td>
      <td>0.191636</td>
      <td>0.931579</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.173130</td>
      <td>0.191742</td>
      <td>0.931579</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A single layer RNN works just as well.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lstm1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lstm1</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin</span><span class="p">(</span><span class="n">h</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span>
    <span class="n">dls</span><span class="p">,</span>
    <span class="n">Model</span><span class="p">(),</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy_multi</span><span class="p">],</span>
    <span class="n">loss_func</span><span class="o">=</span><span class="n">BCEWithLogitsLossFlat</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy_multi</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.694055</td>
      <td>0.693773</td>
      <td>0.500000</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.693572</td>
      <td>0.692401</td>
      <td>0.500000</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.692691</td>
      <td>0.689123</td>
      <td>0.778947</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.690741</td>
      <td>0.678053</td>
      <td>0.600000</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.682890</td>
      <td>0.680005</td>
      <td>0.505263</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.670912</td>
      <td>0.617842</td>
      <td>0.626316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.656362</td>
      <td>0.585949</td>
      <td>0.673684</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.640969</td>
      <td>0.561313</td>
      <td>0.768421</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.623972</td>
      <td>0.539100</td>
      <td>0.778947</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.602667</td>
      <td>0.507333</td>
      <td>0.789474</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.578550</td>
      <td>0.466365</td>
      <td>0.836842</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.543584</td>
      <td>0.395027</td>
      <td>0.915789</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.500915</td>
      <td>0.371571</td>
      <td>0.910526</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.459832</td>
      <td>0.352853</td>
      <td>0.894737</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.423719</td>
      <td>0.319832</td>
      <td>0.915789</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.393652</td>
      <td>0.320621</td>
      <td>0.905263</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.366033</td>
      <td>0.309253</td>
      <td>0.926316</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.344538</td>
      <td>0.316925</td>
      <td>0.910526</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.327254</td>
      <td>0.305492</td>
      <td>0.931579</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.313459</td>
      <td>0.307206</td>
      <td>0.926316</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Seems that dropping down to 1/4th the hidden state size (256 -&gt; 64) we hit a limitation, where the model no longer performs as well.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Coda-type-detection">Coda type detection<a class="anchor-link" href="#Coda-type-detection"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_learner</span><span class="p">():</span>
    <span class="n">dls</span> <span class="o">=</span> <span class="n">datasets_coda</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span> <span class="o">=</span> <span class="mi">128</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model_pretrain</span><span class="o">.</span><span class="n">Model</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;models/pretrained.pth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;pretrained&#39;</span><span class="p">);</span> <span class="c1"># to accomodate the CI pipeline on github</span>

    <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lstm1</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lstm2</span><span class="o">.</span><span class="n">reset_parameters</span><span class="p">()</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lin</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">accuracy</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">learn</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">get_learner</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.485330</td>
      <td>2.294498</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.335705</td>
      <td>2.288693</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.304163</td>
      <td>2.285231</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2.292490</td>
      <td>2.282421</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2.277992</td>
      <td>2.273564</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>5</td>
      <td>2.269981</td>
      <td>2.266062</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>6</td>
      <td>2.265883</td>
      <td>2.258453</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>7</td>
      <td>2.253694</td>
      <td>2.251024</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>8</td>
      <td>2.249751</td>
      <td>2.243055</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>9</td>
      <td>2.239325</td>
      <td>2.232406</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>10</td>
      <td>2.226161</td>
      <td>2.221543</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>11</td>
      <td>2.214585</td>
      <td>2.210638</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>12</td>
      <td>2.208441</td>
      <td>2.204063</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>13</td>
      <td>2.193894</td>
      <td>2.182945</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>14</td>
      <td>2.182949</td>
      <td>2.169889</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>15</td>
      <td>2.170223</td>
      <td>2.158698</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>16</td>
      <td>2.158090</td>
      <td>2.146476</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>17</td>
      <td>2.141515</td>
      <td>2.136356</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>18</td>
      <td>2.134031</td>
      <td>2.131161</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>19</td>
      <td>2.131196</td>
      <td>2.121543</td>
      <td>0.446517</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>20</td>
      <td>2.127353</td>
      <td>2.115347</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>21</td>
      <td>2.110346</td>
      <td>2.100485</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>22</td>
      <td>2.104455</td>
      <td>2.091970</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>23</td>
      <td>2.095030</td>
      <td>2.085384</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>24</td>
      <td>2.088438</td>
      <td>2.080912</td>
      <td>0.446517</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>25</td>
      <td>2.079827</td>
      <td>2.069702</td>
      <td>0.631841</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>26</td>
      <td>2.077063</td>
      <td>2.064379</td>
      <td>0.634328</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>27</td>
      <td>2.068421</td>
      <td>2.061007</td>
      <td>0.634328</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>28</td>
      <td>2.067909</td>
      <td>2.050121</td>
      <td>0.633085</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>29</td>
      <td>2.050233</td>
      <td>2.038246</td>
      <td>0.634328</td>
      <td>00:02</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model doesn't train very well. Let's see what the culprit might be.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interp</span> <span class="o">=</span> <span class="n">ClassificationInterpretation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span>
<span class="n">interp</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model learns to predict the two most common classes and that is it! It does so perfectly though.</p>
<p>It will be very hard to force the model to learn anything about the less represented classes, the class imbalance is severe.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datasets_coda</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">CodaType</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1+1+3    3589
5R1      1510
5R3       642
4R2       340
5R2       287
4D        219
6i        188
8i        178
7D1       177
7i        151
9i        137
4R1        84
2+3        77
1+32       72
6R         67
3D         61
8R         60
1+31       51
9R         43
7D2        35
7R         23
3R         21
8D         20
Name: CodaType, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our best bet at this point is probably oversampling of poorer represented classes. The paper doesn't go into details how the model was trained and the repository also doesn't contain any relevant information, as fat as I can tell.</p>
<p>It's hard to say how the authors approached this problem, but that is not really all that important. Oversampling is a very useful and powerful technique (you can read more about it in this <a href="https://arxiv.org/abs/1710.05381">paper</a>, let's see how far we can take it.</p>
<p>The <code>get_idxs</code> method of <code>DataLoaders</code> samples the <code>idxs</code> to be used in an epoch of training:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">get_idxs</span><span class="p">()[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[3630, 620, 1213, 4444, 4304, 1115, 3522, 4162, 3333, 3139]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">get_idxs</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>7228</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's modify it to return a more equal number of idxs corresponding to each of the classes. Let's calculate the weights we will use for sampling.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">CodaType</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">CodaType</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()[</span><span class="s1">&#39;CodaType&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">CodaType</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6i       475
1+1+3    469
9R       469
7D1      468
4R2      463
4D       462
4R1      449
3D       443
1+32     440
6R       438
3R       437
5R3      434
8D       433
9i       428
7D2      428
7R       427
1+31     414
5R2      414
8R       413
5R1      410
7i       402
8i       395
2+3      389
Name: CodaType, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is looking much better. Let's now pull all of this together.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sample_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">CodaType</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">CodaType</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()[</span><span class="s1">&#39;CodaType&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">100_000</span> <span class="c1"># going for bigger epochs as this will require quite a bit of training</span>
    <span class="n">oversampled_idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">oversampled_idxs</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">get_learner</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_idxs</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">sample_epoch</span><span class="p">,</span> <span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A quick sanity test</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idxs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_idxs</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idxs</span><span class="p">]</span><span class="o">.</span><span class="n">CodaType</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>8D       4467
6R       4438
4D       4403
7D1      4387
7R       4372
5R3      4372
5R2      4369
1+1+3    4364
6i       4361
1+31     4358
7D2      4357
3D       4350
7i       4346
4R1      4342
8i       4342
9R       4341
8R       4330
4R2      4322
1+32     4295
3R       4288
5R1      4282
2+3      4261
9i       4253
Name: CodaType, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us train</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.142259</td>
      <td>2.204962</td>
      <td>0.389303</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.917103</td>
      <td>2.034287</td>
      <td>0.656716</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.808569</td>
      <td>1.923597</td>
      <td>0.728856</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.695975</td>
      <td>1.832408</td>
      <td>0.773632</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.604863</td>
      <td>1.735847</td>
      <td>0.894279</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.537120</td>
      <td>1.651855</td>
      <td>0.966418</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.477692</td>
      <td>1.588840</td>
      <td>0.986318</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.431008</td>
      <td>1.532195</td>
      <td>0.986318</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>8</td>
      <td>1.379324</td>
      <td>1.461624</td>
      <td>0.985075</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>9</td>
      <td>1.332867</td>
      <td>1.400233</td>
      <td>0.992537</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.313218</td>
      <td>1.360112</td>
      <td>0.993781</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.295589</td>
      <td>1.340165</td>
      <td>0.995025</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.291922</td>
      <td>1.331838</td>
      <td>0.993781</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.278093</td>
      <td>1.316814</td>
      <td>0.996269</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.244912</td>
      <td>1.287412</td>
      <td>0.995025</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.240243</td>
      <td>1.285051</td>
      <td>0.995025</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.233052</td>
      <td>1.282633</td>
      <td>0.995025</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.228914</td>
      <td>1.280479</td>
      <td>0.996269</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.226334</td>
      <td>1.266625</td>
      <td>0.996269</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.233800</td>
      <td>1.268806</td>
      <td>0.995025</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We were not exactly able to get to the accuracy of 99.9% reported in the paper. Still, this seems good enough.</p>
<p>Let's see whether we can get a similar result without pretraining and with the entire model unfrozen.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">datasets_coda</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span> <span class="o">=</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model_pretrain</span><span class="o">.</span><span class="n">Model</span><span class="p">())</span>
<span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lin</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">accuracy</span><span class="p">]</span>
<span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_idxs</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">sample_epoch</span><span class="p">,</span> <span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">100_000</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.428250</td>
      <td>0.360457</td>
      <td>0.962687</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.089676</td>
      <td>0.043444</td>
      <td>0.993781</td>
      <td>00:20</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.052602</td>
      <td>0.031867</td>
      <td>0.987562</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.031480</td>
      <td>0.017213</td>
      <td>0.997512</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.024979</td>
      <td>0.027840</td>
      <td>0.993781</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.028536</td>
      <td>0.029325</td>
      <td>0.991294</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.023300</td>
      <td>0.139098</td>
      <td>0.936567</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.027956</td>
      <td>0.013908</td>
      <td>0.995025</td>
      <td>00:20</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.018284</td>
      <td>0.015746</td>
      <td>0.995025</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.017679</td>
      <td>0.029007</td>
      <td>0.993781</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.011762</td>
      <td>0.011826</td>
      <td>0.995025</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.012083</td>
      <td>0.009542</td>
      <td>0.995025</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.012008</td>
      <td>0.004144</td>
      <td>0.997512</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.016163</td>
      <td>0.030589</td>
      <td>0.991294</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.011651</td>
      <td>0.012466</td>
      <td>0.996269</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.005980</td>
      <td>0.004953</td>
      <td>0.997512</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.006988</td>
      <td>0.002272</td>
      <td>0.998756</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.006873</td>
      <td>0.001890</td>
      <td>1.000000</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.006742</td>
      <td>0.001953</td>
      <td>0.998756</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.006238</td>
      <td>0.001294</td>
      <td>1.000000</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Seems that pretraining is not necessary and that training the entire model helps.</p>
<p>Let's also check if we could do with a much smaller model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lstm1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lstm1</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin</span><span class="p">(</span><span class="n">h</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">datasets_coda</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span> <span class="o">=</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">Model</span><span class="p">())</span>
<span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lin</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">accuracy</span><span class="p">]</span>
<span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_idxs</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">sample_epoch</span><span class="p">,</span> <span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">100_000</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.577530</td>
      <td>1.470940</td>
      <td>0.389303</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.001337</td>
      <td>0.967359</td>
      <td>0.666667</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.723600</td>
      <td>0.694374</td>
      <td>0.791045</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.546421</td>
      <td>0.521350</td>
      <td>0.840796</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.401402</td>
      <td>0.455676</td>
      <td>0.838308</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.282333</td>
      <td>0.381733</td>
      <td>0.859453</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.219876</td>
      <td>0.376542</td>
      <td>0.861940</td>
      <td>00:20</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.174598</td>
      <td>0.310206</td>
      <td>0.875622</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.148386</td>
      <td>0.249020</td>
      <td>0.912935</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.162041</td>
      <td>0.284373</td>
      <td>0.880597</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.102815</td>
      <td>0.221196</td>
      <td>0.910448</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.087429</td>
      <td>0.166963</td>
      <td>0.970149</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.083025</td>
      <td>0.163392</td>
      <td>0.961443</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.072956</td>
      <td>0.121880</td>
      <td>0.975124</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.064175</td>
      <td>0.104495</td>
      <td>0.988806</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.060739</td>
      <td>0.102531</td>
      <td>0.986318</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.056660</td>
      <td>0.102899</td>
      <td>0.986318</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.053389</td>
      <td>0.093679</td>
      <td>0.988806</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.052025</td>
      <td>0.091438</td>
      <td>0.990050</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.051068</td>
      <td>0.083065</td>
      <td>0.991294</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A slightly lower accuracy with the same amount of training.</p>

</div>
</div>
</div>
    {% endraw %}
</div>
 

